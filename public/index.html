<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>This is the Title</title>
</head>

<body>
    <h1>Freeze-B-Gone Device Setup</h1>

    <form>
        <fieldset>
            <legend>Freeze-B-Gone Login</legend>

            <label for="username">User Name</label>
            <input type="text" id="username" placeholder="Your User Name ...">

            <br />

            <label for="password">Password</label>
            <input type="password" id="password" placeholder="Your Password ...">
        </fieldset>

        <br />

        <fieldset>
            <legend>WiFi Login</legend>

            <label for="wifinetwork">Wifi Network</label>
            <select id="wifinetwork"></select>

            <br />

            <label for="wifipassword">Wifi Password</label>
            <input type="password" id="wifipassword" placeholder="Your Password ...">
        </fieldset>

        <br/>

        <fieldset>
            <legend>Device Registration</legend>

            <label for="devicename">Device Name</label>
            <input type="text" id="devicename" placeholder="What You Want To Call Your Device ...">

            <br />

            <label for="webip">Website IP Address</label>
            <input type="text" id="webip" placeholder="Your Website IP Address ...">
        </fieldset>

        <br />

        <button type="submit" onclick="submit()" style="display: flex; justify-content: center;">Setup Device</button>

    </form>


</body>

<script>
    var xhttp = new XMLHttpRequest();

    xhttp.onreadystatechange = function() {
        if (this.readyState == 4 && this.status == 200) {
            var wifiDropDown = document.getElementById("wifinetwork");

            wifiNetworks = this.responseText;
            wifiNetworks = JSON.parse(wifiNetworks);

            for(var i = 0; i < wifiNetworks.length; i++){
                var option = document.createElement("option");
                option.text = wifiNetworks[i];
                wifiDropDown.add(option);
            }
        }
    };

    xhttp.open("GET", "wifi", true);
    xhttp.send();

    function submit(){
        var xhttp = new XMLHttpRequest();

        var payload = {
            username: document.getElementById("username").textContent,
            password: document.getElementById("password").textContent,
            deviceName: document.getElementById("devicename").textContent,
            wifiNetwork: document.getElementById("wifinetwork").options[document.getElementById("wifinetwork").selectedIndex].value,
            wifiPassword: document.getElementById("wifipassword").textContent
        }

        console.log(payload);

        xhttp.onreadystatechange = function() {
            if (this.readyState == 4 && this.status == 200) {
                console.log("GOOD");
            }

            console.log("BAD");
        };

        xhttp.open("POST", "submit", true);
        xhttp.send();
    }
</script>

</html>